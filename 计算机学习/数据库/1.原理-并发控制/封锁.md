# 封锁(数据库锁)
#数据库  #并发控制 #数据库锁

## 那么什么是封锁呢？
封锁是实现并发控制的一个有效措施，**那么什么是封锁呢？**
>封锁是**事务T在对某个数据对象**（例如表、记录等操作时）。先向系统发出请求，对其加锁。加锁后事务T就对该数据对象有了一定的控制，在事务T释放它的锁之前，其他事务不能更新此数据对象。

## 封锁有哪些类型呢？

1. 排他锁：简称X锁（又称写锁），若事务T对数据对象A加上X锁，则只允许T读取和修改A，其他任何事务都不能再对A加任何锁。直到T释放A上的锁。
2. 共享锁：简称S锁（又称读锁），若事务T对数据对象A加上S锁，则事务T可以读A但不能修改A，其他事务只能再对A加S锁，而不能加X锁，直到T释放A上的S锁为止。


有了封锁的类型，如何加锁才能使并发操作不会出现数据不一致现象呢？

### 封锁协议
封锁协议：约定了对数据对象何时申请X锁或S锁，持续时间、何时释放等一系列规则。

#### 1.一级封锁协议
事务T在修改数据R之前必须先对其加X锁，直到事务结束才释放。（事务结束包括正常结束（COMMIT）和非正常结束（ROLLBACK））。

#### 2. 二级封锁协议
在一级封锁协议的基础上增加**事务T在读取数据数据R之前**必须先**对其加S锁**
#### 3. 三级封锁协议

## 封锁会带来哪些问题呢？
### 1. 活锁
### 2.死锁 [[死锁]]